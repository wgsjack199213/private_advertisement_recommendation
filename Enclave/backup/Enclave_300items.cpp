/*
 * Copyright (C) 2011-2018 Intel Corporation. All rights reserved.
 *
 * Redistribution and use in source and binary forms, with or without
 * modification, are permitted provided that the following conditions
 * are met:
 *
 *   * Redistributions of source code must retain the above copyright
 *     notice, this list of conditions and the following disclaimer.
 *   * Redistributions in binary form must reproduce the above copyright
 *     notice, this list of conditions and the following disclaimer in
 *     the documentation and/or other materials provided with the
 *     distribution.
 *   * Neither the name of Intel Corporation nor the names of its
 *     contributors may be used to endorse or promote products derived
 *     from this software without specific prior written permission.
 *
 * THIS SOFTWARE IS PROVIDED BY THE COPYRIGHT HOLDERS AND CONTRIBUTORS
 * "AS IS" AND ANY EXPRESS OR IMPLIED WARRANTIES, INCLUDING, BUT NOT
 * LIMITED TO, THE IMPLIED WARRANTIES OF MERCHANTABILITY AND FITNESS FOR
 * A PARTICULAR PURPOSE ARE DISCLAIMED. IN NO EVENT SHALL THE COPYRIGHT
 * OWNER OR CONTRIBUTORS BE LIABLE FOR ANY DIRECT, INDIRECT, INCIDENTAL,
 * SPECIAL, EXEMPLARY, OR CONSEQUENTIAL DAMAGES (INCLUDING, BUT NOT
 * LIMITED TO, PROCUREMENT OF SUBSTITUTE GOODS OR SERVICES; LOSS OF USE,
 * DATA, OR PROFITS; OR BUSINESS INTERRUPTION) HOWEVER CAUSED AND ON ANY
 * THEORY OF LIABILITY, WHETHER IN CONTRACT, STRICT LIABILITY, OR TORT
 * (INCLUDING NEGLIGENCE OR OTHERWISE) ARISING IN ANY WAY OUT OF THE USE
 * OF THIS SOFTWARE, EVEN IF ADVISED OF THE POSSIBILITY OF SUCH DAMAGE.
 *
 */


#include <stdarg.h>
#include <stdio.h>      /* vsnprintf */
#include <vector>

#include "sgx_tcrypto.h"
#include "sgx_error.h"
#include "sgx_trts.h"

#include "Enclave.h"
#include "Enclave_t.h"  /* print_string */

/* 
 * printf: 
 *   Invokes OCALL to display the enclave buffer to the terminal.
 */

/*
void printf(const char *fmt, ...)
{
    char buf[BUFSIZ] = {'\0'};
    va_list ap;
    va_start(ap, fmt);
    vsnprintf(buf, BUFSIZ, fmt, ap);
    va_end(ap);
    ocall_print_string(buf);
}*/


float fm_predict(const float* order_1, const float* order_2, const size_t RANK,  const float bias, const std::vector<int>* nzi) {
    float rating = bias;

    int n = (*nzi).size(); // number of non-zero indices
    for (int i = 0; i < n; i++) {
        int index_1 = (*nzi).at(i);
        rating += order_1[index_1];
        for (int j = i+1; j < n; j++) {
            int index_2 = (*nzi)[j];
            float inner_product = 0.0;
            for (int r = 0; r < RANK; r++) {
                inner_product += order_2[index_1 * RANK + r] * order_2[index_2 * RANK + r];
            }
            rating += inner_product;
        }
    }
    //println!("{}", rating);

    return rating;
}


sgx_status_t decrypt(int cipher_gender, int cipher_age, int cipher_occupation, int* gender, int* age, int* occupation) {

    const uint32_t src_len = 3;
    const uint8_t p_src[src_len] = {uint8_t(cipher_gender), uint8_t(cipher_age), uint8_t(cipher_occupation)};

    const sgx_aes_ctr_128bit_key_t p_key = {0, 6, 0, 8, 0, 3, 3, 0,
                                            79, 0, 15, 0, 0, 0, 4, 2};
    uint8_t p_ctr[16] = {0};
    const uint32_t ctr_inc_bits = 128;
    uint8_t p_dst[src_len] = {0};

    sgx_status_t ret_code = sgx_aes_ctr_decrypt(
                        &p_key, p_src, src_len, p_ctr,
                        ctr_inc_bits, p_dst);
    if (ret_code != SGX_SUCCESS) {
        return ret_code;
    }

    *gender = (int)p_dst[0];
    *age = (int)p_dst[1];
    *occupation = (int)p_dst[2];

    return SGX_SUCCESS;
}

int recommend(int cipher_gender, int cipher_age, int cipher_occupation) {
    int gender = 0, age = 0, occupation = 0;
    sgx_status_t ret_code = decrypt(cipher_gender, cipher_age, cipher_occupation, &gender, &age, &occupation);
    if (ret_code != SGX_SUCCESS) {
        return -ret_code;
    }

    const size_t N_ITEMS = 300;
    const size_t N = 48 + N_ITEMS;
    const size_t RANK = 10;
    
    const float order_1[N] = {0.54984087,  0.49005175,  0.44131264,  0.5139096,  0.5181104,  0.49080586,  0.5116255,  0.4990728,  0.44625992,  0.48452514,  0.42754754,  0.46724698,  0.5317818,  0.5127415,  0.63073605,  0.59642625,  0.5558862,  0.6691433,  0.3842347,  0.29836375,  0.37234703,  0.5769841,  0.4684033,  0.62996244,  0.5857844,  0.49695474,  0.57192236,  0.62364185,  0.48207596,  0.3470869,  0.14238663,  -0.042945784,  0.38033572,  0.22910307,  0.3396292,  0.33945292,  0.6296711,  0.59734493,  0.3018953,  -0.03421921,  -0.30110186,  -0.09378717,  -0.52214617,  0.33345172,  0.3190723,  0.38478398,  0.5759588,  -0.19944668,  0.7567911,  0.11751219,  0.27967146,  -0.29236394,  0.31368494,  0.8214738,  0.6544945,  0.81198823,  0.37032878,  0.31243658,  0.5923844,  -0.4758657,  0.30756757,  0.5564319,  -1.0316069,  0.5673033,  0.97941995,  0.5669073,  -0.012601316,  0.47423887,  0.6054696,  0.13516788,  0.2781604,  0.22101617,  0.74523675,  0.56770587,  0.15605484,  1.5150013,  1.8372328,  0.7730261,  0.36928555,  0.95942765,  0.8948276,  0.6925627,  0.321029,  0.92396027,  0.72685707,  -0.09730113,  0.9882101,  1.1668679,  0.789937,  -0.4655781,  0.55018276,  0.32420492,  0.26630962,  0.110654734,  1.0051346,  -0.73630863,  0.9596455,  1.4627969,  -0.0005976858,  0.85932076,  1.7198331,  -0.24935777,  -0.03941337,  -0.8868298,  0.5545787,  1.00966,  0.7586808,  0.064566955,  0.036795676,  0.7470736,  0.10709658,  -0.53721035,  -0.49599132,  -1.2684622,  0.699843,  0.75972444,  0.8851301,  -1.35378,  -0.15936254,  0.41198364,  1.1244844,  0.11917583,  -0.6561649,  -0.07188711,  0.74189246,  0.48691192,  -0.36552596,  0.6684868,  -0.11802261,  0.8947939,  0.6767755,  -0.31585807,  0.348583,  0.7805762,  -0.63260955,  0.10915367,  0.41858807,  0.5509694,  0.00030240137,  -0.6139437,  -0.41784054,  0.7695836,  0.09225991,  0.87635463,  0.9525649,  -1.1680653,  0.46735698,  0.06801416,  1.1803569,  -0.46301326,  0.6473219,  0.73188746,  0.11544874,  0.6480416,  -0.4690952,  0.33779892,  -0.0007590137,  1.0244836,  0.91576743,  0.46012303,  0.6800517,  0.38006204,  -0.0009386108,  0.57416147,  0.6865813,  0.50508136,  -0.3970341,  0.050671514,  1.219744,  0.1775277,  1.36266,  0.7088523,  1.090289,  -1.3013024,  -1.4916444,  0.5971491,  0.84380436,  1.3983208,  0.21028428,  0.17585456,  -0.00073201564,  0.6353206,  0.050650287,  0.588187,  0.7369999,  -0.47182238,  1.5512724,  0.12635435,  0.7482708,  -0.9408976,  -0.0007062283,  0.7405822,  1.5364374,  0.13065927,  0.8366647,  -0.18208486,  0.60771817,  1.0145183,  0.21393017,  1.9609153,  -1.26298,  0.7448839,  0.4405578,  0.9271399,  -0.105345935,  0.6550345,  0.3683979,  -1.265449,  0.24689312,  0.5952659,  0.39392805,  -0.033289436,  1.08054,  -0.42937604,  0.35634288,  -1.0396869,  -1.5643033,  -0.3252262,  0.8071713,  -0.8719026,  -1.0645298,  -0.23437108,  0.7385646,  1.1542642,  1.002671,  0.8081623,  -0.5944173,  0.6836283,  -1.179187,  0.18421695,  0.91169256,  0.41494536,  0.22838582,  0.07006268,  0.4640672,  1.9154084,  0.891979,  1.2219275,  -0.10310778,  0.48182374,  -0.3140217,  0.8306599,  -0.471418,  0.52606463,  -0.051539507,  0.21037227,  1.0624647,  0.23447925,  0.0818428,  -0.30209765,  0.24799757,  1.0762634,  0.44839704,  0.5847873,  0.17690669,  0.06807996,  -0.1667992,  2.23436,  0.5872756,  -0.4858818,  0.87513995,  1.177227,  0.83153063,  0.3440282,  -0.08671859,  0.09202022,  0.54984707,  -0.63988245,  0.0007499156,  0.5327662,  1.1799996,  0.12345114,  0.2449317,  -0.19277266,  0.49658576,  -0.47644982,  0.48276773,  0.37090623,  0.48706812,  0.69672495,  0.65134966,  -0.21264374,  0.42929217,  0.5326072,  0.2826536,  0.5702852,  -0.8729604,  0.42632115,  0.3151851,  0.6805793,  -0.42732173,  -1.0879357,  -0.50525856,  0.663458,  -0.18815936,  0.27426004,  0.8615528,  -0.31030855,  1.7749119,  0.5146943,  0.8581021,  -0.1057259,  -0.56984526,  -0.08118628,  1.0697731,  -1.9512798,  -0.34532157,  0.61885345,  0.61565435,  0.84558135,  0.68404883,  0.28364065,  0.91837597,  -0.29845643,  0.047381606,  0.4091329,  0.76566464,  -0.1590769,  0.42333782,  0.8239279,  0.41082975,  -0.24791652,  0.07679187,  -0.022090178,  0.4293966,  0.13746938,  0.8021763,  0.4651391,  0.7163686,  0.38977385,  0.06707552,  -0.0009989827,  0.00077466585,  -0.40283805,  0.4682361,  0.5162948,  0.59974945,  0.7032779,  -0.25348878,  -0.12243859,  0.43940836,  0.4166376,  0.24607588,  0.81884086,  0.8757081,  0.9715196,  0.72157407,  0.7278429};

    const float order_2[N][RANK] = {0.11932558, 0.07537147, 0.19426006, -0.01939109, -0.106261395, -0.027909398, 0.16512455, -0.15748115, 0.16329889, -0.13491184, 0.11559107, -0.024217017, 0.005565866, 0.020333374, 0.0814076, -0.04561162, -0.020747568, 0.07703213, 0.0081120245, 0.00036348432, -0.27785823, 0.08934742, -0.021653175, 0.04970164, -0.11675455, -0.37043083, -0.21357125, -0.46468753, 0.13959666, -0.27176234, -0.31098044, 0.044741325, -0.06389325, 0.050428998, 0.15396765, 0.099836044, -0.22865038, 0.0981985, -0.09972245, -0.060058534, -0.059425697, 0.005440282, -0.1385401, 0.013864342, -0.010518403, -0.000134864, 0.12820166, -0.022389181, -0.13313915, -0.06834457, 0.107119635, 0.040747527, -0.058679026, 0.06433437, -0.0116969105, -0.045027032, 0.0054447227, 0.02981193, 0.16673577, 0.010957278, 0.16175734, -0.035613585, 0.13600114, 0.04070706, 0.07310498, -0.111196026, -0.12857747, 0.052293483, 0.2509678, 0.017949436, 0.016962605, -0.11685715, 0.23881412, -0.1453458, 0.15374228, -0.052608762, 0.002362789, 0.08933857, 0.31853297, -0.0044829394, 0.032150883, -0.07736816, 0.23428941, -0.2506241, 0.037668858, -0.34036887, 0.053623367, 0.124878824, 0.3679331, 0.14090237, -0.11599764, -0.0029207133, -0.12926486, 0.07630439, -0.096166976, -0.01365939, 0.006015323, -0.036989555, 0.0012173273, -0.15147406, 0.0034974422, -0.024331333, -0.044722922, 0.014203948, 0.08321873, 0.014635082, 0.2208496, 0.039647806, -0.011847419, 0.0098560555, -0.037634403, -0.21257561, 0.023219224, -0.095820814, 0.3869292, -0.3261538, 0.022907693, -0.12741376, -0.039263915, 0.065396704, 0.037076592, 0.008120515, -0.07494454, -0.03266544, 0.041390978, 0.036663953, 0.08133726, -0.03994882, 0.01957193, -0.24543086, -0.15931375, 0.06666684, -0.07925073, 0.020256951, 0.14667825, 0.007916703, 0.16452594, -0.039215952, 0.05579943, 0.31151217, -0.32582176, 0.061897416, -0.08364027, -0.11992435, -0.19079255, -0.04530413, 0.058632914, -0.10679687, -0.08092206, -0.14526723, 0.12237197, 0.14846809, -0.22532499, 0.18921898, -0.031528186, 0.118385226, 0.08537378, 0.077352956, 0.01573582, 0.052276004, -0.010080256, -0.021816986, 0.0128292395, -0.06530468, -0.0005124052, -0.14930572, -0.11455819, 0.08625555, -0.012030662, -0.14038111, 0.3064257, -0.014013798, -0.14000241, 0.1029114, 0.061068792, -0.9396322, -0.32366756, 0.02863863, -0.13070695, 0.2978262, -0.3728168, 0.08961765, 0.11425315, -0.40683463, -0.08571157, 0.296114, -0.17649257, 0.3110703, 0.28666076, -0.46011427, -0.071586385, 0.07321424, -0.039228655, 0.08202571, 0.26729807, -0.14427528, -0.32325906, -0.26548776, -0.02646606, -0.23833214, 0.22206709, 0.05946242, -0.2119651, 0.059642103, 0.13751155, 0.019293234, -0.19999304, 0.25523084, -0.045723945, -0.2227009, -0.2462611, -0.0783986, 0.007573535, 0.006768327, -0.08433957, 0.11428028, 0.08467415, 0.10413448, 0.06893248, -0.045120124, -0.27144286, 0.22588335, 0.109701954, -0.36459398, 0.08734098, -0.27501303, -0.20097172, -0.13342251, -0.05672799, -0.068260096, 0.013767943, -0.037104126, -0.061041117, 0.03583614, 0.049677458, -0.18196724, -0.030975435, 0.036797762, -0.071526095, 0.011691569, -0.029528087, 0.03977298, 0.15508398, 0.2320924, 0.21370155, 0.14281416, -0.10473312, -0.01606834, 0.16658969, 0.079554684, 0.22963569, 0.048632424, -0.11176339, 0.035925493, -0.03031852, -0.10958647, -0.09558525, 0.15499017, 0.037002042, -0.08851638, -0.1758722, 0.027341159, -0.046365757, 0.04832731, -0.1163073, 0.09817968, 0.005973703, 0.013200172, 0.038072266, -0.11991488, -0.28544915, 0.20119537, -0.23923841, 0.23878233, -0.70290774, 0.09587465, -0.22270513, 0.14345375, 0.016680796, -0.08082783, -0.032727234, 0.08427405, -0.05557242, -0.04048714, 0.04773782, -0.37607706, -0.1614825, -0.029702757, 0.008931158, 0.110147886, 0.108807005, -0.05125463, -0.094437875, -0.11133097, 0.29921797, -0.1303257, 0.15945154, 0.07303728, -0.014893146, 0.098667085, 0.003627553, -0.14013809, -0.25373843, -0.14249998, -0.046891324, 0.093140356, -0.1925153, -0.12999518, 0.19807178, 0.09096718, 0.05383885, -0.19618179, 0.12736091, -0.1589321, -0.07980225, 0.31606817, -0.09179571, -0.16174442, -0.06836686, 0.1013721, 0.19620344, -0.017854964, -0.20543705, 0.018046133, -0.05994624, 0.09436444, 0.07851242, -0.032765914, -0.03679083, -0.081851356, 0.06578583, -0.08141377, -0.16171792, -0.05497841, 0.033019427, -0.07591992, 0.13790497, -0.05514851, 0.3066597, 0.012246794, -0.009864172, -0.06929105, -0.19567491, -0.057850815, 0.07768163, 0.24178596, -0.0047720904, -0.10484128, 0.29476276, -0.048427235, -0.15875389, -0.04474933, -0.08678454, -0.018483939, 0.10239555, -0.08998787, -0.0024403138, 0.0041626133, -0.010430294, 0.0066864784, 0.0028755304, 0.011589808, -0.33832034, -0.035001855, 0.24963917, -0.26586866, 0.09533534, -0.08449292, 0.40311125, -0.04377422, 0.01891246, 0.0008195421, -0.032733537, 0.0043848343, -0.110836886, -0.00608611, 0.009524099, 0.03813113, 0.01640689, 0.10452708, 0.1930186, -0.19096929, 0.14751387, -0.1567137, -0.089208625, 0.22970718, -0.1354206, -0.15378368, -0.28245366, 0.17089619, 0.24837492, -0.44581553, -0.4790993, -0.53624123, -0.25550258, 0.36638317, -0.30721185, -0.29928377, 0.22536123, 0.44751662, -0.36462942, -0.10932771, -0.23975722, -0.10782523, -0.052685402, -0.05311321, -0.10748987, -0.026857484, 0.23918743, 0.17810777, -0.24555649, -0.21959417, -0.21502481, -0.13411494, 0.026451971, -0.11388191, 0.04026777, -0.192845, 0.46709216, 0.056456603, -0.27733663, -0.10232546, -0.23726259, 0.12319166, 0.11309082, -0.42411846, 0.054011997, 0.03502438, 0.7182138, -0.0944809, -0.040079497, -0.088216156, -0.006549433, -0.1102378, 0.026298465, 0.025071997, -0.008031783, -0.08444655, 0.12864712, 0.018029917, 0.0004447784, -0.068576835, -0.07316538, -0.027281575, -0.032354113, 0.060850117, -0.038900465, -0.037261635, -0.03854031, 0.02067837, -0.13526288, -0.05217207, -0.026510334, -0.05486156, 0.07040253, 0.022957355, -0.060317487, -0.034078468, -0.018961148, -0.013678447, -0.017173728, 0.055706676, 0.004552738, 0.039809614, 0.060979463, 0.018689442, -0.1904796, 0.07955326, -0.21637163, -0.07349525, 0.18524048, -0.3277454, -0.13258739, -0.2737495, -0.12924041, 0.4543055, -0.25118536, -0.2988462, 0.043933395, 0.009782242, 0.060308672, 0.15886451, -0.20489883, 0.12985827, -0.07652848, 0.1599541, 0.117149666, 0.08226461, -0.06915695, -0.16128208, 0.26704848, -0.30632854, -0.042608853, -0.3114752, -0.24788472, 0.27084875, -0.36066702, -0.32248235, 0.3940891, 0.15863736, -0.25417984, -0.13317962, -0.025752822, -0.090058506, -0.27812937, -0.07619882, -0.5814166, -0.5979078, -0.23224579, 0.015288549, 0.6934677, -0.6260722, 0.7234453, -0.6912217, -0.7492228, 0.8523511, -0.54126406, -0.9384091, 0.06724473, -0.24602662, -0.4015629, 0.07379954, -0.00699865, 0.1497479, -0.010471237, -0.66975224, 0.37261435, -0.19924237, 0.78517324, -0.3708169, 0.16569847, -0.22508816, -0.2489589, -0.17991321, -0.28584906, 0.17655791, -0.34842163, -0.19734514, -0.539945, 0.30249888, -0.64264065, 0.33236474, 0.63678515, 0.11881838, -0.074408285, 0.64431566, 0.18142389, 0.08769001, -0.009755757, -0.22279611, 0.48112524, 0.15599674, -0.0658937, 0.15743954, -0.65089935, 0.481583, -0.2642135, -0.118351094, 0.21972257, -0.47807547, -0.4041674, -0.12196457, 0.53835857, -0.28953445, 0.30970904, -0.77649254, -0.96055853, 0.4989226, 0.45165458, -0.2224926, 0.16393843, -0.33654863, -0.1003561, -0.29641342, -0.18023296, 0.12677757, -0.62474555, -0.41486633, 0.25029257, 0.30303633, 0.1282145, -0.02502293, 0.44886833, -0.11058621, -0.38078347, 0.13398719, -0.10725037, -0.276779, -0.1548672, 0.17267981, -0.28069028, -0.38839984, 0.34024864, -0.30990475, -0.31194848, -0.17196341, -0.85839224, -0.77023125, 0.8343806, -0.5403199, 0.1174834, 0.19247487, 0.35838872, -0.1723238, -0.14441212, -0.6397292, 0.59245944, -0.15335734, 0.6348039, 0.21215041, -0.2037744, 0.035686664, -0.75641036, 0.0845293, 1.2866412, -0.64864445, 0.89096797, 0.29167742, 1.5377672, -0.9220535, 0.2743562, -0.50486875, 0.15707877, -0.4969674, -0.38618785, 0.34480506, -0.13919005, -0.2887969, 0.80581355, 0.28302512, -0.75406706, 0.06716508, -0.57917273, 0.30396706, 0.3029543, -0.18407238, -0.14290525, 0.25613832, 0.07391935, -0.7233365, -0.48932958, 0.8005037, 0.59611946, 0.49371693, 0.28782874, -0.37789455, 1.0321938, 0.63251173, 0.3110927, -0.50518346, -1.4942895, 0.41039306, 0.16497192, 0.59195346, 0.29176733, -0.35955098, 0.85997295, 0.8012315, -0.27985442, -0.20987098, -0.6932854, -0.6561526, -0.94348377, -0.38264275, -0.4177225, 0.037137374, -0.24261887, -0.58869976, -0.32108074, 0.51292753, 0.1578437, 0.04127164, -0.16916797, -0.22942117, 0.17623958, 0.2968031, 0.5803168, 0.38659367, -0.17829116, -0.073936805, 0.2196443, -0.10315697, 0.32443616, -0.06454942, -0.083846964, 0.12324473, -0.2265498, -0.27026445, -0.330624, 0.3435299, 0.25443175, -0.49705148, -0.24635439, -0.5602772, -0.5092295, 0.53389156, -0.5862136, -0.5844058, 0.5080706, 0.5876425, -0.46644142, -0.47419596, 0.036121313, -0.111242026, -0.011307135, 0.16246119, -0.3570857, 0.3382369, 0.83421296, 0.055528704, 0.3549229, -0.4843794, -0.0073055783, -0.31375206, 0.00925347, -0.025353186, -0.035686255, -0.1635407, 0.15353405, 0.2599819, -0.28522754, 0.17809421, -0.5384682, 0.26355046, 0.43840432, -0.1950465, 0.10430604, 0.3488481, -0.21608111, -0.21434782, -0.44135875, 0.19778456, -1.6861293, 0.12046319, 0.19597133, -0.32967195, 1.1512712, 0.56408376, 1.3626859, 0.34943643, -1.0452105, 0.07972344, -1.0909051, 0.015322389, -1.2156839, 0.7938423, -1.2284756, -0.4000733, 1.7166653, 0.15660031, -0.22372882, 1.5214939, 0.49575457, 1.4857589, 0.6725504, -0.9699655, 1.453024, 1.4962512, -0.042703606, -1.5693679, 0.30239668, 0.65643746, 1.3691239, 0.98477614, 0.5090554, 0.8071822, 0.6573359, 0.75234854, -2.1410947, -0.27541447, 0.22237729, 0.39728343, -0.2778782, 0.23887935, 0.4743837, -0.6102425, 1.179356, 0.57689494, 0.3342449, -1.8263417, 0.013326128, -0.2982851, -0.7664984, -0.38237372, -0.1717908, 0.00074710767, 0.20188653, -0.33960333, 0.6926855, 0.7754495, -0.7340592, 0.48186016, -0.28025424, 0.70662105, 0.81374055, -0.746782, 0.5625088, 0.6482304, 0.079413645, -0.6642472, -0.49396044, -0.21253498, -1.0301147, -0.34968606, -0.22194964, -0.44383404, -0.5961714, -0.06404997, -2.4233584, -0.29666156, 0.5282352, -0.055903114, 0.058761895, 0.018784875, -0.33891103, 0.11750134, 0.1529294, 0.0063729966, -0.25406387, 0.1694345, 0.20507501, -0.13870989, 0.3816672, -0.034423955, 0.34023604, 0.49340463, -0.4009864, 0.054345455, 0.2355299, 0.10166565, -0.90566874, 0.873319, -0.8220982, 0.8302429, 0.8212116, -0.986234, 0.8754193, 0.75795686, 1.3076947, -0.9370398, 0.6352627, -0.3049265, 1.4597809, -0.42782283, -0.25801167, -0.6430012, -0.5267766, -0.1905962, 0.675262, -0.79974586, -0.5751017, -0.59068763, 1.2118073, -0.7354453, -0.52951837, -0.33750355, 0.19738394, -0.10307751, 1.997744, 0.018703226, 0.1163624, 0.53156334, 0.29129797, 0.37144452, 0.13652466, -0.14699923, 0.66636354, 0.25601998, 0.010598025, -0.36188728, -2.3967721, 0.9192011, -0.107668854, 0.7275748, 1.5938396, 0.016743332, 1.6104239, 0.78462946, 1.7817087, -1.7494544, -0.5659768, 0.49488947, -0.4044041, 0.26236153, 0.76683307, -0.42464206, 1.1358173, 0.5279155, 1.0635563, -0.17758399, 0.5398574, -0.62756836, 0.00014873804, -0.73592705, -0.2634056, 0.43146202, -0.57524574, -0.63083947, 0.050930325, 0.4853621, -0.6878526, 0.33956343, -0.64279914, 0.43025616, 0.23915973, -0.2993653, 0.2648277, 0.5025902, 1.6338927, -0.34617704, -0.22229032, -0.08870434, -0.36973983, -0.15967433, -0.051565707, 0.16048537, -0.48657963, -0.20188086, -0.08107638, -0.18387993, 0.3684913, -0.29654223, -0.45581916, -0.17656374, 0.2249876, -0.19950274, 0.045856796, -0.39202213, 0.18291618, 0.4771932, 0.041907746, -0.3488849, 0.708447, -0.24807373, -0.019473251, 0.4461666, -0.055494726, -0.30081576, 0.08918346, 0.33449474, -0.4235545, 0.65283585, 0.14078291, 0.6775477, 0.460832, -0.50568736, 0.21746479, 0.5776396, -0.28543946, -0.3271577, 0.018517096, -0.38318694, 0.35225075, -0.62632275, -0.12476513, 0.60302824, -0.46290576, -0.35903692, 0.48609638, 0.4881616, -2.0216281, 0.748458, -1.0804622, 0.64408433, 0.9488485, 0.071506515, -1.2052996, 0.33764926, 0.37970248, 0.60591376, -0.52686954, 1.06565, 1.0375981, 1.016005, 0.6382355, -0.88879794, 0.9992246, 0.933706, -0.72536117, -0.7069447, -0.0008173726, -0.00038112263, -0.0008203605, 0.00028020958, -0.00044872548, -5.582045e-05, -0.0007880545, -0.00021163299, -0.00092281203, 0.00037557678, -1.2435664, 0.83681655, -0.32596257, 0.823232, 0.990254, -1.6769272, 0.826923, 0.63633454, 0.64129263, -0.8596242, -1.8006645, 1.6288908, 0.05937341, 1.6647769, 1.4156355, -1.4770523, 1.7496351, 1.4730219, 0.57886815, -0.78985053, -0.8865766, -0.3693628, 0.51661885, -0.7131882, -0.62566465, 0.3825777, -0.53398734, -0.8094049, 0.34206182, 0.77565855, 1.3377229, -0.8179754, -1.5343773, -1.0432936, 0.19721271, -1.1604937, 0.08391977, -0.8146424, 1.3506267, -0.91628337, 0.1532956, -0.50326014, 0.42745614, -0.6902018, -0.7204679, -0.54105544, -0.96093476, -1.2571142, 2.4230614, -0.37585375, -0.7250651, 0.24549976, -1.0163484, -0.017537711, 0.3555488, -1.0059302, 0.23891222, -0.3492234, 0.93673104, -0.8167056, -0.54706323, 0.6638112, 0.29176408, 0.44843537, 0.62098825, -0.90340465, 0.77947885, 0.84346616, 0.1631046, -0.22996363, 0.86209124, -0.16103134, -2.8702672, -0.17556597, -1.4673296, -1.6226015, 2.189558, -0.6671003, -2.0120316, 0.51888525, 0.29817504, -0.33015695, -0.20069723, -0.30744937, -0.24115795, 0.26565412, -0.24256922, -0.28575742, 0.37061065, 0.21728544, 0.22402114, -0.42349997, 0.05620636, -0.4530594, -0.8222503, 0.7268595, -0.6324354, -0.58245045, 0.9026782, -0.3462704, -0.9606642, 0.5109099, -0.6347183, 0.46465024, 0.3553054, -0.36840287, 0.0881469, 0.8991066, 1.6430737, -0.981714, -1.3218552, -0.394889, -0.056625187, -0.6006966, 0.69942784, -0.9858945, -0.12640215, -0.15823661, 0.5200858, 0.3275142, -0.08433861, -0.5517185, -0.039350152, -0.45551178, -0.65493464, 0.47654667, -1.0867026, -0.89713424, -0.25250864, 0.18756884, -0.19859856, -1.013273, -0.061051447, -0.99330586, -0.6172666, 0.69659096, -1.0517051, -0.8852792, 0.06932084, 0.5455525, 0.25291893, -1.0616078, -0.64463794, -0.9308532, -0.6967371, 0.472375, -0.862092, -0.84529704, 0.40345916, 0.6363349, -0.67604643, 0.07549725, -1.7715316, 1.0290372, -0.08396749, 0.3026825, 0.3047772, 0.91797894, 0.47376415, -0.032275144, -0.48231015, 0.21701376, -0.023762252, -0.028504925, 0.03608648, 0.2499495, 0.5120159, 0.4746054, -0.030266028, 0.091971934, -1.2365971, 0.69067645, -0.5331472, 0.8048811, 0.67285305, -0.4852731, 1.1534761, 0.88974196, -0.31648004, -1.0364698, 0.39334515, -0.5019785, -0.32503885, -0.47564963, -0.28661048, 0.29998234, -0.34040037, -0.33465153, 0.38516593, 0.032372113, 0.23971136, -0.5073345, -0.17460445, -0.7275454, -0.53744155, 0.4333191, -0.46857068, 0.17805177, 0.048511863, -0.23125473, -0.9923466, 0.015371501, -0.071646236, -0.046190977, 0.8769505, 0.17725961, -0.41784406, -0.12373249, 0.5573281, -0.22924292, -0.79770064, 1.0586679, 0.26953632, 0.7262391, -0.2236512, -0.87371653, 0.66419506, 1.1255511, 0.3340416, -0.7223348, 0.18935308, -0.50596595, 0.5357541, -0.3787709, -0.7462944, 0.7889327, 0.038370673, -0.26452667, -0.44873363, 0.22073215, 1.7024535, -1.1878883, 0.09826956, -0.9166107, -0.8216721, 0.37293503, -1.2283608, -0.9778852, -0.29139918, 0.43675905, -0.129796, -0.6223306, -0.32396147, -0.39220744, 0.06759903, 0.3442906, -0.29823768, -0.060374442, -0.29574567, 0.39543217, -0.26649073, -0.23051156, 0.04871498, -0.41808346, 0.6226639, 0.07261678, 0.18896423, 0.49298733, 0.34276238, 0.5705816, -0.21759173, 0.11135541, -1.4620239, 0.14896825, 1.1073736, 0.09358232, 0.92672646, 0.37584502, 1.2508719, 0.30636096, 0.18667448, -1.0175004, 0.1603689, -1.0959759, -0.5163802, 0.38227344, -1.2052274, -0.97252977, 0.338114, -0.63503814, 0.53554845, 0.48280373, -0.23463356, 0.4585758, 0.48052132, -0.48134753, 1.0842526, 0.9856999, 0.55860406, -0.6891972, -0.052419405, -0.53161633, -0.6726603, -0.5997952, -0.34991252, 0.5612647, -0.6528514, -0.4455061, 
-0.54179096, 0.75147355, -1.0610305, 1.2293782, -1.1266087, 0.8311696, 0.505008, -0.59040827, 0.8004887, 0.69077474, 1.5948626, -1.3099953, 0.39165214, 0.69191283, -2.5206547, 1.4429306, 1.313, 0.16882314, 1.0344459, 0.79661214, 0.75360674, -0.331111, 0.54205644, -0.7248077, 1.8055995, -0.0809219, -0.2577146, 0.40393683, -1.5476613, -2.1067972, 1.1018784, -0.25424537, -0.32099387, 0.05185361, -0.024565123, -0.26994902, 0.34399003, -0.43866915, -0.331815, -0.109962955, 0.12937398, 0.52054864, 0.40048152, 0.2819115, 0.24679534, 0.3924062, 0.026293784, 0.5213759, 0.08416594, 0.46777812, 0.75899416, 0.43013695, 1.1179347, -0.7784912, 0.8196359, -0.81632024, -0.97383374, 0.33640987, -0.6887511, -0.5727367, 0.74750173, 0.39220783, -0.6786176, 0.20368716, -0.2620602, 0.15884383, -0.17605044, 0.65356404, -0.5053046, 0.26062128, 0.79951227, 0.022436066, 0.1216142, -0.2451795, 0.119961314, -0.32588845, -0.3298388, 0.1373607, -0.18703565, -0.19155222, 0.085958526, -0.14046595, 1.3641909, 1.2302468, 0.45754126, 1.5323511, 1.5843228, -0.051434353, 1.337845, 0.82523704, 0.9936323, -1.2914999, -0.00037756108, -0.0006014159, 0.00038168696, 0.0008802116, -0.00083360414, -0.00048148516, 0.0009962403, -0.00021721242, -0.00011398009, -8.919742e-07, -0.052459855, -1.0367085, -0.69519836, -0.8521268, -0.11726971, 1.0744295, -0.6092491, -0.8075274, -0.20073399, 0.2566751, 0.5903113, -0.8599354, -0.12978691, -0.8630941, -0.82797354, -0.040787376, -0.23464948, -0.91113997, -0.5095173, 0.276525, -0.41022032, 0.6941191, -1.1718835, 0.72786134, 0.667399, -0.8826077, 0.29114527, 0.7889817, 0.9793588, -0.03439798, 0.16642132, -0.29557467, 0.12794611, -0.32177708, -0.39719734, 0.4668158, -0.4723193, -0.26947442, 0.29507852, 0.1480735, -0.42278397, 0.9646663, -1.0658741, 1.7550565, 0.89356023, -0.6941712, 0.8211279, 1.7544672, 1.4020802, -0.49456263, -0.8202417, 0.52500004, -0.9907908, 0.24491334, -0.008997976, -0.25229967, 1.0041068, 0.81854975, 1.1929642, -2.2197547, 0.7497759, -1.0773565, -0.19171074, -1.1093835, -0.83150524, 0.49600348, -0.22432022, -0.9752491, 1.1097751, 0.15538357, 0.9229887, 0.077535555, -0.64739466, 0.3106405, -0.00043132616, -0.005389803, -0.4709798, -0.107988164, -0.22043343, -0.68966526, 0.39618307, -0.6967911, -0.6524042, -0.4656522, -0.17049974, -0.13370012, -0.38777003, -0.30563983, -0.2730303, 0.23879175, -1.2576097, 1.1346298, -0.5508273, 1.1053001, 1.2491649, -1.6372887, 1.0736692, 0.99561596, 0.1431913, -1.1024486, -0.119657464, -1.374121, -0.3986197, -1.0623674, 0.46764138, -0.04502119, -0.4770227, -1.0915867, -1.1594177, 0.6576698, 1.3854975, -0.20604694, -0.049109414, 0.22007844, -0.24416208, -0.9344537, 0.17602481, 0.5540311, -0.57667136, -0.35836372, -1.7477422, 0.7660689, -0.9716613, 0.87761474, 0.68302333, -0.7171261, 0.58092785, 0.67587227, -0.2885976, -0.66674817, 0.17888583, -0.31484687, 0.535698, -0.57006633, -0.19610354, 0.040812537, -0.14491059, -0.3469082, 0.11126721, -0.006425153, 0.039556894, -0.50549483, 0.89656085, -0.8020245, 1.3378032, 0.17382084, -0.5073837, 0.33649582, 1.166574, -3.9486942, 0.1167845, -0.49405628, -0.23318462, -0.4306671, -0.23809187, 0.22939895, -0.50336725, -0.4623928, -0.1325059, 0.42813453, -0.505258, 0.547393, -4.9752116, 1.4945383, -0.5471498, 0.10272611, -0.6088145, 0.030644897, -3.251333, 0.3666857, -0.0008056076, 0.0008092745, -0.00042860414, 0.00061794184, -0.0001451862, 0.00042045978, 0.00073928, 0.00012088299, -0.0006619158, 0.0004938076, -0.121112876, 0.4125834, 0.15350334, 0.3720253, 0.11256365, -0.09562876, -0.19195895, 0.3950287, -0.5036492, -0.10030319, -0.5246421, 0.46045414, -0.20656168, 0.7328938, 0.8519464, -0.7692358, 0.87101233, 0.64200217, 0.5409046, -0.28525963, 0.36905232, -0.42417714, -0.11248172, -0.4185095, -0.29870033, 0.4029407, -0.27989173, -0.3887601, 0.092887774, 0.3635269, 0.7585784, -0.21670853, -0.043042183, -0.0623799, 0.31451815, 0.20587984, 0.12113707, 0.25346068, 0.46328256, 1.0064111, -0.12233228, -0.35573974, 0.18456772, -0.95064455, -0.5882844, -0.44635102, 0.9052961, -0.56442034, 0.31048396, -2.8581674, 0.00016172673, 0.0005765088, 0.0007213219, -3.5270234e-05, 0.0009531699, -0.00016900682, 0.00043064216, 0.0006495557, 0.00019785622, -0.00033340836, 0.61106175, -0.029219955, -0.06201311, -0.80520844, 1.3050797, -0.54675573, 0.97119135, -0.23647463, -0.6902143, -0.6768639, -1.529978, 1.0236952, 0.9665788, 0.584546, 1.0334681, -0.20352843, 1.108765, 0.39380765, 1.4033096, -0.8226011, -0.14493959, -0.37965062, -0.67588073, -0.02320207, 0.091951266, -0.14111589, -0.2414431, -0.099603295, -0.9874625, 0.522829, -3.4745371, 0.35530782, 2.9976304, -3.2825627, 1.6769389, -0.12371769, -1.945647, -1.4620252, 0.24630731, 0.53608537, 0.52341604, -1.0281327, -0.74240416, -1.0288076, -0.5572229, 0.9206711, -1.0253083, -0.89746726, 0.7666718, 0.8018019, -1.4142351, 1.029205, -0.7336983, 1.2058811, 1.680539, -1.0993577, 0.4276026, 1.4098548, 0.49434873, -0.60731536, 0.43416733, -0.46169713, 0.16778614, -0.28924537, -0.5681275, 0.34062627, -0.18096235, -0.38369343, -0.36153913, 0.12721959, -0.382395, -0.016666027, -0.39330584, 0.10826409, 0.019406922, -0.3133694, -0.054127194, 0.2943623, -0.59120744, 0.4773468, -1.0278413, -0.31997555, 0.098099396, -0.2068045, -1.0055395, 0.7291245, -1.1151245, 0.38123977, 1.2186941, -4.056541, -0.6045876, 1.0229163, -0.2853347, 1.2601376, 0.9242221, -1.56837, 1.2141898, 0.88856655, 0.64958686, -1.0992143, 0.25266764, -0.64323384, -0.22649217, -0.79416263, -0.25070414, -0.015549269, -0.33368632, -0.40643835, 1.3059995, 0.4560437, 0.7829859, -1.5768532, -0.010658864, -1.2422593, -0.80950403, 1.5674077, -1.5285174, -1.2355803, 0.2359474, 0.8709987, 0.6523498, 0.32075924, -0.49570817, 0.3913262, -0.12384044, 0.11123995, -0.299075, 0.41792604, 1.6377708, -0.28713697, 0.21550155, -0.18343243, -0.15527552, 0.26428613, -0.22549726, 0.83894795, -0.3304794, 0.2909603, -0.942619, -0.6403801, -2.1332717, 0.3363626, -3.0472057, 1.267972, 3.2092674, -1.4123386, 0.7061299, 1.0399624, 0.59927714, 0.18525678, 0.45752957, -0.09783262, -0.6321433, 0.31957978, -0.67916477, 0.6876539, -1.224011, -0.031423405, 0.4535569, 0.7018794, 0.27161697, -0.64323366, -1.0529412, 0.112460256, -0.6080248, 0.42430747, -0.9649888, -0.28018394, 0.07547835, 0.5268669, -0.00089725474, -0.00017336296, -0.00027952885, -0.00016199017, 8.517795e-05, 0.0006665428, 0.0002979479, -0.0008417361, 0.00048424676, 0.0005747132, -0.031174175, 0.09828209, -0.59854627, 0.07920668, 0.20131019, -0.1245599, 0.092651986, 0.12039682, 0.4301096, -0.12863418, -0.70485824, -0.14478606, -0.42109513, -0.41139722, -0.13989377, 0.17033969, -0.14572091, 0.29783204, 0.90132856, 0.4682443, -0.8196023, 0.035460226, 2.6645114, -0.042648744, -0.7696064, -1.7390579, -2.2668107, -0.702352, 3.380852, 2.2975357, 0.0038973084, -0.44062772, -0.23540989, 0.33625188, -1.291904, -0.035001166, -1.5114458, 0.5084226, 0.32659578, -0.04163626, -1.0577245, -2.0549362, 4.0629816, -0.8678542, 1.8497343, 2.4044569, -3.0035965, -0.22403207, 5.667714, 0.8858892, -0.106834896, 1.0961858, 0.7902658, 1.0988643, 0.23020384, -1.0565861, 0.9025209, 1.0301932, 0.06788614, -0.1615976, 0.0387256, -0.25407714, 0.8144066, -0.4054518, -0.5566895, 0.40446687, -0.45926592, -0.26061332, 0.37097964, -0.30692482, -0.6270568, 0.90808684, 0.08435271, 0.80109286, 0.54065436, -0.53992015, 1.0105504, 0.9100374, 0.92848164, -0.7440774, 1.0056081, -1.3454465, -0.32157692, -1.3264027, -1.0420376, 1.1175925, -1.2078958, -1.2866087, 0.43861577, 0.7154652, 0.00024084025, -0.000272748, -2.0156149e-06, -0.0003315666, -0.0008040717, -2.0841137e-05, -0.0007735515, -0.00056521303, -0.00036121154, -0.00085006526, -0.68821, 0.67360365, -0.30575892, 0.680687, 0.6753295, -1.0091331, 0.9912781, 0.6752359, 0.48708192, -0.552429, -0.44214973, 1.2990519, 0.19888788, 1.1416155, 0.64283556, -0.5393537, 0.66760904, 0.92321265, 0.19730534, -0.9876688, 1.2681751, 0.89323646, 1.9894217, 0.17028911, -2.1030235, 0.44242397, 1.7260928, -0.2219836, 1.5140228, -0.67165196, -1.12745, 0.47460237, -0.47266674, 0.29251048, 0.18270814, -0.23960567, -0.09145916, 0.31580147, 0.7341368, -1.9490069, 2.0703378, -1.0077598, -2.6687245, -0.29023936, -1.3254133, 0.13664855, -0.59321713, -0.16034567, -0.5504117, -1.3346469, 0.22026916, -0.2839095, -0.15953846, -0.3041571, -0.36304688, 0.1162293, 0.19211042, -0.4719139, -0.28728923, -0.026842298, -0.8031123, 0.8479929, -0.5886291, 0.82096547, 0.6467786, -1.0200753, 0.81526524, 1.0269312, 1.2674363, -0.9530808, 0.26889095, -0.3486124, 0.33874747, -0.42896724, -0.3139132, 0.3438208, -0.11207673, -0.3047229, 0.1097753, 0.1532993, 1.1238415, 0.6026704, -0.24206461, 0.69526035, -0.06923251, -0.66018665, 1.5440123, 0.7836197, -0.88072526, 0.26538822, 0.30056778, -0.6071737, 0.029274791, -0.68008935, -0.5224101, -0.14950936, -0.46546426, -0.60577744, 0.5902726, 0.37373468, -0.3185312, 0.5991322, -0.6181826, 0.48235056, 1.1674107, -0.83499455, 0.5442604, 0.62449515, 0.86241215, -0.5003853, 0.20302433, -0.0050708773, 0.5638751, 0.15462781, -0.40200907, 0.5073763, -0.34227714, -0.22218372, 1.414322, -0.027036736, -0.42265078, 0.8931104, -0.48728263, 0.63398105, 0.5950803, -1.3249629, 0.74824065, 0.8402134, 0.16380256, -0.62004566, -0.22030564, -0.53600127, 0.24215522, -0.71336573, -0.40461066, 0.89457905, -0.15063451, -0.28554428, 1.0852427, 0.82286716, 0.17035179, 0.19627786, 0.41191372, -0.0071773413, -0.1478578, 0.16276787, -0.5648636, -0.30549482, 0.64790326, 0.107166536, -0.94027615, 0.0638637, -1.1313039, -0.15387683, 0.8780068, 0.19377989, 0.58986044, 0.2214511, 1.6477641, 1.1906763, -0.08444128, -0.47173992, -0.8260251,
 -0.7447197, -0.2866895, 0.17907105, -0.31771252, -0.3749976, 0.6813825, 0.23998676, 0.38438836, -0.3925115, -0.300151, -0.39585644, -0.2060196, 0.30013344, -0.3257106, -0.32191843, 0.0800573, 0.35572916, -0.048772056, -0.05317823, -0.89006454, -0.06020252, 0.18690047, -0.38843888, 0.17962271, -0.11997716, 0.23684056, 0.3104023, 0.25772503, -0.37924024, 0.061610166, -0.2966591, -0.31421152, 0.33202335, -0.38541257, -0.24076828, -0.41998085, 0.41279343, 0.24778141, -0.4451201, -0.47800282, -0.5362501, -0.25599623, 0.36620784, -0.3076515, -0.2992708, 0.22800867, 0.44850138, -0.118139476, 0.20110364, 0.4248362, 0.115333945, 0.22205766, -0.3201849, -0.24376133, 0.04317233, -0.038250126, 0.13073675, 0.23946893, -0.91889215, -0.081614725, -1.0491992, -0.8906592, -0.053541627, -1.5136337, -0.9473432, 0.2826026, 0.017099515, -0.2017593, 0.15823925, 0.87661934, 0.046027426, -0.193306, -0.45847103, 0.9657273, -0.37240925, 2.1139827, -1.4123336, 0.18413022, -0.45374992, -0.0018622191, -0.503034, -0.2893527, 0.27977207, -0.44737884, -0.5243084, 0.19302718, 0.07292348, 0.30556956, -0.67588913, -0.062763475, -1.0707685, -0.556426, 0.6273512, -0.47533765, -0.67872465, 0.8496518, -0.005795721, -0.046990164, -0.4946419, -0.10111152, -0.5229821, -0.4535417, 0.4914366, -0.6834315, -0.53489316, 0.42415932, 0.44790626, -0.5751606, 1.116548, -0.46134531, 1.275286, 0.48649898, -0.6657277, 0.50798565, 0.99302137, 0.87233377, -0.4772387, 0.11917639, -0.7091562, 0.08780287, -0.6486588, -0.57311505, 0.6044969, -0.48250964, -0.5528287, 0.44823453, 0.22366932, -0.0605991, -0.48582208, -0.38474017, -0.53571534, -0.34218836, 0.21691434, -0.35857487, -0.44328082, 0.43365085, 0.2958752, 0.017088378, -0.6413238, -0.21546361, -0.68991464, -1.4685489, 1.1319454, -1.1020291, -0.55545473, 0.047086515, -0.7136926, -0.4184418, 0.024148062, -0.23643175, 0.07238234, 0.56265235, -0.3708738, 0.070338145, 0.39220428, 1.3819436, -0.9517773, -0.7131831, 1.158829, -0.066402845, 0.9258037, 1.021684, -1.6105298, 1.589021, 0.97215384, 0.7971234, -0.9446567, -0.017515173, 0.45280614, 0.008285016, 0.4471999, -0.18502091, 0.24699192, 0.46784836, 0.62138855, 0.23021491, 0.13566655, 1.1770993, 0.52798545, 0.42828813, 0.9581886, 0.71750915, -1.7656678, 1.3073351, 0.5990037, 0.52988154, -1.1973125, 0.12712091, -0.6616991, 0.25954682, -0.5846972, -0.94711983, 0.8285492, -0.41049415, -1.2247416, 0.3635354, 0.97692955, -1.9055741, 0.91170394, -0.5967461, 0.825293, 0.5401403, -0.2909854, 0.62516856, 0.82378674, 0.040438958, -0.65702677, -0.2656995, -0.74295086, -0.18076831, -0.7170146, -0.47136575, 0.89700323, -0.53146255, -0.60355, 0.04332465, 0.43391323, 0.03254587, -0.1180624, -0.27976254, 0.24302147, -0.62610006, 0.2252245, 0.27260804, -0.70088345, 0.13658157, -0.41416267, 1.6865176, 0.8831887, -0.9416344, 1.1090871, 0.018831037, -1.3286498, 0.13243715, 1.7643161, 0.010595873, -1.6053865, 0.119318016, -0.18925215, -0.69206834, 0.15677713, 0.9608213, -0.029444031, 1.4447503, 0.19747224, 0.9095298, 1.1953807, 0.3137383, -0.30973253, 0.18818533, -0.30918685, -0.36932528, 0.36253074, -0.075968586, -0.3665867, 0.9882686, -0.03834489, -0.35953283, -0.43259326, -0.16705813, -0.5464679, 0.51747197, 0.08952956, -0.2758059, -0.052166793, 0.23558272, -0.14934751, -1.4174253, 0.5057707, -0.32365674, 0.36641294, 0.38941577, -0.11262889, 0.40643585, 0.4691863, 0.81900036, -0.30243123, 0.3529818, 0.9881844, 0.12965013, 0.7824979, -0.63069415, -0.4915997, 0.42326254, 0.9864592, -0.68740153, 0.12833633, -0.8994867, 0.52238476, 0.4196281, 0.70566195, 1.0807399, -2.1849844, 0.23901182, 1.1465964, 1.4594927, -0.8947186, -0.3288829, 0.7464129, 1.7356728, 1.2355977, 1.2864585, -1.0217059, 1.6757326, 1.4041306, 0.26793236, -0.469514, 0.37247124, -0.12962231, -1.4799535, -1.324206, -0.918875, 1.0280685, -0.25128093, -0.619916, 0.9086346, -0.313564, 0.15438075, -0.24561083, -1.0040225, -0.22172359, -0.07623608, 0.27267516, -0.35819378, -0.19508837, 1.0634147, 0.7765919, 0.074880585, -0.87672156, -0.7342053, -0.79074496, 0.45290384, 0.93416315, -1.2047997, -0.57524437, 0.3680856, 0.26052913, -0.9393302, 0.51258343, -0.45243952, 0.36276865, 0.7750988, -0.6213554, 1.0643724, 0.8609847, 1.0867356, -0.58811563, 0.39924616, -0.6023366, 0.44601232, -0.5635683, -0.74027497, 0.6084476, -0.5551615, -0.7591183, -0.24312796, 0.33045003, 0.21461457, -0.13255247, -0.28638735, -0.17606518, -0.5648415, -0.072798274, -0.3154435, -0.1407534, 0.59984565, -0.058807496, 1.3268455, 0.18157583, -0.8771831, -0.06445529, 0.07793529, -0.1204735, -0.6775264, -0.19815178, 1.9788344, -1.6535717, 0.16274838, -0.3350934, -0.11926782, -0.32996807, -0.25882632, 0.50711644, -0.26147547, -0.34132007, -0.23265475, 0.5796887, -1.006562, 0.7849511, 0.04498731, 0.73060143, 0.10307008, -0.88076204, 0.92622983, 0.81835973, 0.23904115, -1.1548319, 1.046019, -0.83042693, -2.3926773, -0.2541954, -2.5572884, 0.090630725, -0.4818631, 0.02903891, 1.9284632, 1.369659, 0.21514812, -0.922619, -1.6483012, -0.28281513, 0.05829641, 0.6238692, 0.025956172, -1.1364193, 2.4482872, -0.50717926, 0.5487928, -0.6541139, -0.29997447, -1.1060858, -1.18937, -0.06988454, -0.303246, -1.105636, -0.6875833, -0.85633016, -0.80459625, 0.41078293, 0.40189466, 0.05858233, -0.19051008, -0.8339081, 0.7897839, -0.4486544, 1.3720104, -0.49205452, 0.33493632, 0.3907127, 0.40922385, 0.14803766, 0.68674433, -0.9962093, 0.005132499, 1.2458639, -0.316405, -0.9497552, -0.08334015, 0.022008665, -1.2731359, 0.14830993, 0.7827831, -0.043302745, 0.2673706, -0.08857387, -0.48450378, -0.30452728, -0.062558435, 0.05162113, 0.4218717, -0.062296063, 0.57470006, 0.25124714, 0.002058236, -0.2672972, 1.0489798, 1.1666057, 0.08451877, -0.19261932, 0.18985389, -0.43964672, -0.15725218, 0.79048246, -0.40151823, 0.052538797, 0.28580627, -0.24480274, 0.12486594, -0.20814388, -0.42232737, -0.20140564, -0.26111245, 0.0932993, -0.24967882, -0.29592553, 0.107404366, 0.23638472, 1.0580554, -0.5730323, -1.1818503, -0.032912906, -0.04162634, 1.3882383, -0.5688914, -0.014093593, 0.16848224, 0.984023, 0.06511729, 1.1240528, 1.0407271, -0.13997076, 0.058213025, -0.46763998, 0.19955812, -0.35226074, -1.0570679, 0.49031445, 0.53090894, 0.30729073, -1.6313876, 0.8075662, -0.5354619, -0.57073474, 0.32583043, 0.70584387, 0.8906476, -1.5133004, 0.64308864, -1.1154633, 0.70598996, -0.8928907, -0.45950243, 0.49905467, -1.2855748, -0.48977727, 0.7149525, -0.005871776, 0.14476085, 0.6868008, -0.37369582, 0.56930923, 0.71414, -1.4523647, 0.7648212, 1.1213523, 0.9551615, -1.4627374, -1.095094, 1.2105477, 1.8012925, 1.0705653, 0.40983617, -0.56579506, 1.1278868, 0.9881906, 2.3533964, -1.0010917, -0.6113053, 0.43711147, 0.20403989, 0.3143014, 0.71234447, -0.46986225, -0.08889353, 0.5096582, 0.08235463, 0.09981887, -1.6615288, 0.28302798, -0.45999125, 0.2338498, 0.64517933, -0.70226103, -0.120751, 0.1582627, 0.20609145, -0.5141365, 0.9082741, -1.0742722, -0.061170187, -0.6194233, -0.613161, 1.0893068, -0.10931144, 0.013646441, 0.32418185, 0.63264793, -0.36258227, -0.3593738, 0.18566543, -0.5406504, -0.69096464, 0.6889357, -0.31986368, -0.4883185, 0.11878477, 0.21235444, 0.501058, -0.2798818, -2.7853162, 0.27399424, 0.982608, -0.65490425, -1.5359064, -0.02651944, 1.2256958, -1.4521376, 0.22849073, -0.720898, -1.106157, -0.49516007, 0.3549817, -0.049661312, 0.122062504, -0.14356129, 0.38573247, 1.304372, -0.00072140555, -0.00013541174, 0.00060840056, 9.881088e-05, -0.0004296322, 0.0008262211, 0.0008045016, 0.00094371417, -0.00056424807, -0.00040697982, -0.12552306, 0.23233287, 0.2757257, 0.17906883, -0.089353696, -0.10213586, 0.5583172, -0.025127629, 0.18873425, -0.15177731, -1.0852839, 1.2286242, -0.76922274, 1.28651, 1.0569673, -1.1675346, 1.058652, 1.1135808, 0.07245759, -1.1441298, 0.55670506, -0.34552068, 0.5274446, -0.30943173, -0.4853689, 0.23299131, -0.18399966, -0.4952627, -0.090148695, 0.47154367, 0.29000154, -0.71215284, 0.20956819, -0.4932162, -0.18503006, 0.07694535, -0.44592217, -0.19401948, 0.5508614, 0.024740616, 0.34619707, -0.9874676, -0.84882617, -0.950713, -0.6472693, 0.5049094, -0.7793949, -0.8596372, 0.8022048, 0.4681728, -0.6055349, 0.31558004, 0.25900984, 0.017271195, -0.2194782, -0.28414458, -0.095558725, 0.08227351, 0.7349933, -0.3101097, 1.1326165, -0.684393, -1.6340078, -0.5025384, -0.44888216, 0.79086363, -1.2485844, 0.3342632, -0.28631327, 0.41763118, -0.9300494, 0.066313475, -0.62212116, 0.16970524, 0.31289157, 0.4995179, -0.06906087, 0.12359376, -0.13049215, -0.014201684, -0.12082665, -0.31521824, -0.15731664, -0.2114966, -0.16522981, -0.04704338, -0.36987138, -0.010275338, 0.60122085, 0.007812177, -0.9508954, 0.21594921, -1.5706689, 0.65434396, 0.5509783, -0.8088774, 0.003812645, 0.44924155, -0.5635057, -0.6741414, -0.21691746, 0.38428745, -0.5830054, 0.47799507, 0.62637985, -0.5301982, 0.7471692, 0.44573706, 0.6362649, -0.13044563, -0.44252616, 0.45661113, -0.90016395, 0.4541523, 1.016367, -0.7056345, 1.0645779, 0.28876522, 1.5273796, -1.0920087, 0.1342002, -0.47200358, -0.09181646, -0.57369345, -0.657895, 1.5916528, -0.25375012, 0.096770234, 0.16422449, 0.6180379, -0.14392273, -0.08539829, -0.9428996, 0.17623626, 0.4842642, -0.3305252, -0.012504849, -0.30465394, 0.03908559, -0.15860772, 0.08226844, 0.22689539, 0.68522936, 0.22764009, -0.40902415, -0.02693126, 0.22272116, -0.45217082, 0.23344979, 0.023446457, 0.053958938, -0.31466547, 0.36158764, -0.17609517, -0.07709625, 0.65343475, -0.16605043, -0.0714031, -0.25032452, 0.38036352, 0.5029375, -0.15506993, 1.1771803, -0.40231752, -0.09367709, -0.3819907, 1.2266454, -0.24018916, 0.4783614, -0.17807107, -0.20232071, -0.788291, 0.3471635, -0.784271, -0.4113901, 0.570522, -0.5954718, -0.55761755, 0.20180999, 0.67241013, 2.0720286, -0.46230853, -1.6530818, -0.16240615, -0.06061233, 0.9439416, -0.7331372, 1.5734769, -1.1163151, -1.4136407, -1.2481452, 0.16665335, -1.5905309, -0.01031516, 0.5196349, -0.2252246, -0.95612526, 0.11444886, 0.38643166, 0.5198097, -0.9540936, 0.54870695, 0.38032714, 0.62333137, -0.6614095, -0.29524025, 0.024540871, 0.36556324, 0.5538863, -0.032327347, 0.4474388, -0.3885918, -0.384938, -0.47998244, 0.19230567, 2.356269, 0.3747978, -0.395839, 0.27731636, 0.7146766, 0.7351449, -1.096298, -0.4833995, -1.0792902, 0.6626116, 0.796687, -0.41116777, -0.30880028, 0.03051666, 1.3206122, 0.11289169, -0.4850755, -2.2696636, -0.85585296, 0.842382, 0.9916284, 0.33840787, -0.64012134, -1.3977098, 0.62465215, -0.028727803, 0.080936305, -0.6654049, 0.037163273, 0.26942927, -0.23295721, 0.12042084, -0.05222312, 0.47782743, -0.40301174, 0.28198832, -0.36678502, 0.12409416, -0.34839216, -0.2512637, 0.42124048, -0.41786072, -0.38676095, -0.30525997, 0.3258587, 0.005054769, -0.24286978, -0.6982424, 0.00095592346, 0.14174467, -1.5256922, 0.099133186, -0.16583708, 0.4719682, -0.5369276, -1.207258, 0.46089777, 0.58723134, 0.32660568, 0.22193983, -0.0603144, -0.008180729, 0.34830624, 0.24323799, -0.467005, -1.2180723, -0.56291264, -0.029043833, -0.3001811, -0.263204, 0.04475828, -1.6441361, -0.7657262, -0.110167354, 0.7445282, 0.41959992, 0.92589504, 1.3219844, 0.7495839, 0.62719184, -0.90479314, 2.1435559, 0.5434191, 1.0014466, 0.5696159, -0.36582968, 0.14135017, 0.58009267, -0.010574887, 0.03615375, 0.3957528, -0.14546806, 0.168957, 0.09573484, -0.13748345, -0.77744555, 0.62172616, -0.1647234, 0.5634548, -0.19840927, -0.41041037, 0.099462636, 0.18233743, -0.014142148, -0.23937291, 0.29959825, -0.7008153, -1.5431994, -1.1590471, 1.0468615, -0.95385146, 0.4733891, -0.20044468, 1.1070365, -0.093632676, -1.1847836, -0.69993585, 0.07935566, -0.9054009, -0.031513087, 0.07334117, -1.4274548, -1.5571297, 0.8870549, 0.76873, 0.41897318, -0.6565645, 0.61368567, -0.71521354, -0.19826896, 0.4109187, -0.36644712, -0.26681373, 0.63552755, 0.56335896, -0.09610002, -0.27500388, -0.016035492, 0.2241347, -0.23039402, 0.2040026, 0.2784438, -0.017995711, 0.12633754, -0.39920983, -0.1711911, -0.61039317, -0.17741612, -0.6470094, -0.38237804, -0.6449357, -0.21587695, -0.38032886, 0.76379853, 0.28345856, 0.32556725, -0.8173915, -0.41249678, -0.85097796, -0.68544984, 0.74587363, -0.45904613, -0.829662, 0.77723324, 0.48712513, 0.2756176, -0.18731244, 0.26868957, -0.13507056, -0.13876201, 0.46372217, -0.19612198, -0.15788706, -0.607566, 0.22367725, -0.7260807, 0.65083903, -0.50276214, 0.2952699, 0.4560329, -0.20582911, 1.2340655, 0.27889663, 1.6583567, -0.6775958, -0.31412187, 0.76062423, -0.020593446, 0.79687595, 0.583707, -0.041606933, 0.38866553, 0.7868657, 0.34679466, -0.48527646, 0.87894106, 0.30213335, -0.8388077, 1.6609917, 0.6069224, 0.19813055, 0.90200514, 1.3777975, 1.3878199, -1.540551, 2.1911585, -0.6810477, 1.0138688, -0.8260096, 1.3776475, 0.09449557, 1.5550634, 0.64998233, 1.4214994, 0.99987525, -0.3419152, 0.67757654, 0.20402488, 0.39589033, 0.38897723, -0.49752617, 0.62182987, 0.5373726, 0.2721173, -0.653452, 0.2294851, -0.40442422, -0.12794434, -0.33166453, -0.46482474, 0.26223034, -0.03654277, -0.35127133, 0.059905462, 0.35723442, -0.6943946, -0.4003226, -0.028203825, 0.016772622, -0.9055831, -0.4696497, -0.4825525, -0.56044614, 1.3855588, 0.36683232, -0.85513574, 0.50620186, -1.7448854, 0.1334896, 0.20569313, 0.20908384, 0.31436312, -0.023511946, 1.8517543, 0.7594533, -0.47482666, 0.16882281, -0.3057988, 0.23244962, 0.91632336, -1.0093001, -0.1914949, 0.6628263, 0.78858066, -1.8064548, -0.44144428, -0.1093167, 0.273145, -0.8337511, 0.06403192, 0.91099983, 0.16012058, -0.38198677, 0.38877872, -0.34060946, -0.4637057, -0.30131248, -1.0565517, -0.20075043, 0.83889586, -0.14987968, 0.0043841666, -0.44784725, 1.3238276, -1.7363509, -1.0657525, 0.54176724, -0.71086967, 0.565874, 1.3123463, -0.8754571, 0.9231403, 0.3098961, 0.8492539, -0.5233587, 0.11329339, -0.024664164, 0.09618285, -0.2700602, -0.4539881, 0.4553062, -0.31062922, 0.050048996, 0.73108387, -0.0064724293, 1.2132175, -1.0258024, -0.7766607, -0.58265465, 0.14325806, 0.585921, -1.3104779, -0.29252732, -0.8793628, -0.6360046, 0.20243436, -0.39141533, -0.049197286, -0.30820486, -0.4090742, -0.5488261, -0.91507787, -0.33453816, 0.75720465, 0.33614513, 0.21113692, -0.5020855, 0.19423643, -0.34915832, -0.23232983, 0.056861497, -0.64165884, -0.5051623, -0.13848099, 0.34140798, -0.19031261, -0.17869058, -0.5824217, -0.40921855, 0.08941124, 0.5037427, 0.71066576, 0.25665557, 0.6860844, -0.25679785, -0.22778386, 0.33116752, -0.4081552, -0.50325364, 0.8481741, -0.20777778, 0.9178667, -1.195923, -0.86673737, -1.07668, -0.31434023, 0.5823214, -2.2897549, 0.9501595, 1.0657594, 0.23977928, 1.6646792, 0.13246737, 0.4394775, -1.6972532, -0.44750756, -0.20051306, -0.27456728, -0.07054563, -0.46205103, 0.06797402, 0.26309967, 0.08583184, 0.23295704, -0.016005808, -0.8024054, 0.37232885, -1.3239026, 0.16509561, 0.91782635, -0.6013064, 0.75189734, 0.6593348, 0.81307554, -0.97855943, -0.44029635, -0.0830071, 0.0040840902, -0.33715293, -0.46146464, 0.039463647, 0.05623143, -0.14047913, 1.612927, -0.7041031, 0.63514525, -0.9671036, -1.668434, -0.36934447, -0.17053314, 1.9957908, 0.46422154, 0.1669488, 0.89911324, 0.36173725, 0.00014855526, -0.0008272832, 0.00043934374, -0.00023616315, 0.00083022483, 6.925245e-05, 0.0007160986, 0.0006361023, 2.8554e-05, -8.554006e-05, 0.00022961933, 0.00010441255, -0.00045111158, 0.0003263374, -0.0009594143, -0.00048320083, 0.00025396585, 0.00046344858, 0.00055505754, 0.00074949337, 0.13375174, -0.4530017, 0.072124265, -0.4680384, -0.3142955, 0.4305134, -0.35329023, -0.39070916, 0.11632379, 0.30343047, -0.5822989, -0.10918799, -0.31676954, 0.2091707, -0.46825308, 1.0657151, 0.707044, -0.57740915, -0.8878244, -0.53629947, -0.040366627, -0.10426966, -0.02506033, -0.18240982, -0.18514122, -0.07679058, -0.23732322, -0.28932637, -0.3979782, 0.066962436, -0.15126623, 0.32738963, 0.49231085, 0.45502794, -0.20602906, 0.3010535, 0.06611186, -0.10720993, 0.11438966, -0.30197534, -0.37543315, 0.3586226, 0.28490853, 0.04552515, 0.4122881, -0.42243677, 0.67420787, 0.6208875, 0.56654465, -1.024368, -0.6394673, -0.47914296, -0.90325093, -0.8053642, -1.4421748, 0.15807985, -2.2295957, -0.62652206, 0.9264347, -0.06076223, 0.16209887, -0.42460436, 0.29126737, -0.50109524, -0.33046705, 0.5217857, -0.6373687, -0.5003929, 0.14934681, 0.30773202, 0.23568182, -0.42484996, -0.1957251, -0.41223902, -0.50488627, 0.3064935, -0.44755673, -0.35228324, -0.26748252, 0.55079293, -0.62216246, 0.32896703, 1.0935451, 0.39523187, -0.44712466, 0.8625688, -0.45062134, -0.13496892, 0.5534443, 0.099094816, -0.4696866, -0.3429728, -0.8406542, -0.46280038, -0.16508886, -0.046785332, 0.07147555, -0.52190197, -1.1957465, 0.91203916, -0.56824756, 0.6470518, -0.7030066, 0.8852063, 0.74926263, -0.60094804, 0.6554514, 0.748003, -0.063591495, -0.793589, -1.0729883, 0.18692523, -0.02479638, -0.0047082924, -2.3566108, 1.33699, 1.3676273, -0.6077664, 2.6812909, -0.42554775, -0.6358689, 1.3428599, 0.21914396, 1.3055893, 0.16990355, -1.5433402, 1.7524239, 0.4223687, 1.0197061, -0.8347484, -0.7522586, 0.6025469, -0.38969088, 0.6921382, 0.933325, -0.32332173, 1.1521381, 0.20820965, 1.526662, -0.7357363, -0.5255659, 0.48050836, -1.1808075, 0.582869, 0.98118377, -0.797862, 0.5625759, 0.60088146, 1.2888012, -0.8677426};


    std::vector<int> genres[N] = {std::vector<int>{2,3,4}, std::vector<int>{1,3,8}, std::vector<int>{4,13}, std::vector<int>{4,7}, std::vector<int>{4}, std::vector<int>{0,5,15}, std::vector<int>{4,13}, std::vector<int>{1,3}, std::vector<int>{0}, std::vector<int>{0,1,15}, std::vector<int>{4,7,13}, std::vector<int>{4,10}, std::vector<int>{2,3}, std::vector<int>{7}, std::vector<int>{0,1,13}, std::vector<int>{7,15}, std::vector<int>{7,13}, std::vector<int>{15}, std::vector<int>{4}, std::vector<int>{0}, std::vector<int>{0,4,7}, std::vector<int>{5,7,15}, std::vector<int>{15}, std::vector<int>{7,14}, std::vector<int>{7,13}, std::vector<int>{7}, std::vector<int>{7}, std::vector<int>{13}, std::vector<int>{1,14}, std::vector<int>{7}, std::vector<int>{7}, std::vector<int>{7,14}, std::vector<int>{1,13}, std::vector<int>{3,4,7}, std::vector<int>{7,13}, std::vector<int>{7}, std::vector<int>{6}, std::vector<int>{4}, std::vector<int>{4,13}, std::vector<int>{7}, std::vector<int>{7,16}, std::vector<int>{0,5,7}, std::vector<int>{7}, std::vector<int>{0,1}, std::vector<int>{4,7}, std::vector<int>{7,13}, std::vector<int>{5,15}, std::vector<int>{2,3,11,13}, std::vector<int>{7,13}, std::vector<int>{5,15}, std::vector<int>{0,7,15}, std::vector<int>{4}, std::vector<int>{7}, std::vector<int>{3,4}, std::vector<int>{7}, std::vector<int>{1,3,8}, std::vector<int>{7}, std::vector<int>{7,13}, std::vector<int>{7,12}, std::vector<int>{1,3,8}, std::vector<int>{7,15}, std::vector<int>{7}, std::vector<int>{4}, std::vector<int>{4,13}, std::vector<int>{4}, std::vector<int>{14,15}, std::vector<int>{7}, std::vector<int>{4,13}, std::vector<int>{4}, std::vector<int>{0,4,5,10,15}, std::vector<int>{0}, std::vector<int>{4,7}, std::vector<int>{7,11}, std::vector<int>{7,13}, std::vector<int>{4,7}, std::vector<int>{14,15}, std::vector<int>{6}, std::vector<int>{7}, std::vector<int>{7,15}, std::vector<int>{7}, std::vector<int>{5,7,13}, std::vector<int>{7}, std::vector<int>{7}, std::vector<int>{4,7}, std::vector<int>{7,13}, std::vector<int>{1,7}, std::vector<int>{3,4}, std::vector<int>{4}, std::vector<int>{0,15}, std::vector<int>{7}, std::vector<int>{}, std::vector<int>{7,15}, std::vector<int>{4,13}, std::vector<int>{7}, std::vector<int>{0,15}, std::vector<int>{4}, std::vector<int>{7}, std::vector<int>{0,15}, std::vector<int>{6}, std::vector<int>{7,15}, std::vector<int>{4}, std::vector<int>{4}, std::vector<int>{15}, std::vector<int>{4}, std::vector<int>{7,13}, std::vector<int>{4,7}, std::vector<int>{1,3,4,11}, std::vector<int>{6}, std::vector<int>{4}, std::vector<int>{0,7,16}, std::vector<int>{7,15}, std::vector<int>{0,1,5}, std::vector<int>{7,12}, std::vector<int>{7}, std::vector<int>{4}, std::vector<int>{6}, std::vector<int>{5}, std::vector<int>{4,13}, std::vector<int>{4}, std::vector<int>{7}, std::vector<int>{7}, std::vector<int>{4,13}, std::vector<int>{7,12,13}, std::vector<int>{7}, std::vector<int>{4}, std::vector<int>{1,3,8}, std::vector<int>{7}, std::vector<int>{6}, std::vector<int>{4,13}, std::vector<int>{7}, std::vector<int>{7,13}, std::vector<int>{15}, std::vector<int>{4,7}, std::vector<int>{6}, std::vector<int>{4}, std::vector<int>{6}, std::vector<int>{6}, std::vector<int>{7}, std::vector<int>{0,7}, std::vector<int>{7,13}, std::vector<int>{4}, std::vector<int>{7}, std::vector<int>{7}, std::vector<int>{4}, std::vector<int>{0}, std::vector<int>{1,3}, std::vector<int>{7}, std::vector<int>{7}, std::vector<int>{5,7,15}, std::vector<int>{7}, std::vector<int>{7,13,16}, std::vector<int>{10}, std::vector<int>{0,1,4,5}, std::vector<int>{7}, std::vector<int>{7,16}, std::vector<int>{4}, std::vector<int>{4,16}, std::vector<int>{1,3}, std::vector<int>{7}, std::vector<int>{0,1,12,14}, std::vector<int>{7,15,16}, std::vector<int>{6}, std::vector<int>{0,13,15}, std::vector<int>{5,9,12,15}, std::vector<int>{0,15}, std::vector<int>{4,7}, std::vector<int>{7}, std::vector<int>{0,1,7,13}, std::vector<int>{1,3,7}, std::vector<int>{0,5,15}, std::vector<int>{4}, std::vector<int>{0,14,15}, std::vector<int>{0,1,14}, std::vector<int>{4}, std::vector<int>{7}, std::vector<int>{4}, std::vector<int>{10}, std::vector<int>{4}, std::vector<int>{7,13}, std::vector<int>{4}, std::vector<int>{0,3}, std::vector<int>{7,13}, std::vector<int>{15}, std::vector<int>{7}, std::vector<int>{14,15}, std::vector<int>{4}, std::vector<int>{4}, std::vector<int>{10}, std::vector<int>{4}, std::vector<int>{15}, std::vector<int>{7}, std::vector<int>{6}, std::vector<int>{7}, std::vector<int>{7}, std::vector<int>{4,7,13}, std::vector<int>{10,14}, std::vector<int>{7}, std::vector<int>{0,5,14}, std::vector<int>{7,11}, std::vector<int>{15}, std::vector<int>{7}, std::vector<int>{7,13}, std::vector<int>{4}, std::vector<int>{0}, std::vector<int>{4,7}, std::vector<int>{6}, std::vector<int>{7,13}, std::vector<int>{0,1}, std::vector<int>{7}, std::vector<int>{17}, std::vector<int>{7}, std::vector<int>{4}, std::vector<int>{7}, std::vector<int>{7}, std::vector<int>{7,13}, std::vector<int>{4}, std::vector<int>{7,15}, std::vector<int>{4,7}, std::vector<int>{7}, std::vector<int>{10}, std::vector<int>{}, std::vector<int>{7,13}, std::vector<int>{4}, std::vector<int>{4,7,13}, std::vector<int>{7,15}, std::vector<int>{15}, std::vector<int>{0}, std::vector<int>{4}, std::vector<int>{7,15}, std::vector<int>{7,15}, std::vector<int>{4}, std::vector<int>{4,7}, std::vector<int>{7}, std::vector<int>{4}, std::vector<int>{4,7}, std::vector<int>{4,13}, std::vector<int>{4,13}, std::vector<int>{1,3}, std::vector<int>{2,3,4,13}, std::vector<int>{15}, std::vector<int>{3,7}, std::vector<int>{7,11}, std::vector<int>{4}, std::vector<int>{2,3}, std::vector<int>{5,7}, std::vector<int>{6}, std::vector<int>{7,8,13,15}, std::vector<int>{4}, std::vector<int>{7,13}, std::vector<int>{3,4}, std::vector<int>{0}, std::vector<int>{4,13}, std::vector<int>{7,10}, std::vector<int>{7}, std::vector<int>{4}, std::vector<int>{4,14}, std::vector<int>{12,15}, std::vector<int>{1,3,4,8,13}, std::vector<int>{5,7,15}, std::vector<int>{0,1,8,14}, std::vector<int>{7}, std::vector<int>{3,7}, std::vector<int>{7}, std::vector<int>{7}, std::vector<int>{7,13}, std::vector<int>{7,13,16,17}, std::vector<int>{4}, std::vector<int>{7}, std::vector<int>{7}, std::vector<int>{7,13}, std::vector<int>{7}, std::vector<int>{7}, std::vector<int>{7,10}, std::vector<int>{4}, std::vector<int>{4}, std::vector<int>{4,13}, std::vector<int>{7}, std::vector<int>{4}, std::vector<int>{7}, std::vector<int>{7,15}, std::vector<int>{7}, std::vector<int>{7}, std::vector<int>{5,7}, std::vector<int>{0,5}, std::vector<int>{7,10}, std::vector<int>{0,14,15}, std::vector<int>{4,13}, std::vector<int>{0,15}, std::vector<int>{4,13}, std::vector<int>{5,7}, std::vector<int>{15}, std::vector<int>{0,7,15}, std::vector<int>{5,7,13,15}, std::vector<int>{4,13}, std::vector<int>{4,13}, std::vector<int>{5,7}, std::vector<int>{7}, std::vector<int>{4}, std::vector<int>{7}, std::vector<int>{7}};

    float bias = 0.50734335; 

    const int N_GENDER = 2;
    const int N_AGE = 7;
    const int N_OCCUPATION = 21;
    // number of movie feature categories - Genre: 18
    const int N_GENRE = 18;

    const size_t n_items = N - N_GENDER - N_AGE - N_OCCUPATION - N_GENRE;
    
    if (gender >= N_GENDER || gender < 0) {
        return -2;
    }
    if (age >= N_AGE || age < 0) {
        return -3;
    }
    if (occupation >= N_OCCUPATION || occupation < 0) {
        return -4;
    }

    std::vector<int> non_zero_indices;
    non_zero_indices.push_back(gender);
    non_zero_indices.push_back(N_GENDER + age);
    non_zero_indices.push_back(N_GENDER + N_AGE + occupation);

    
    size_t best_id = 0;
    float best_rating = 0.0;
    
    // We also return the 2nd and 3rd best item with some probability to add some noise
    // to the recommendation result.
    // To defend against model stealing.
    size_t second_id = 0, third_id = 0;
    float second_rating = 0.0, third_rating = 0.0;

    for (int m = 0; m < n_items; m++) { 
        // Compute the rating for the m-th item

        std::vector<int> nzi = non_zero_indices;

        // Add the movie.genre indices
        for (auto it = genres[m].begin(); it != genres[m].end(); ++it) {
            nzi.push_back(N_GENDER + N_AGE + N_OCCUPATION + *it);
        }
        //nzi.push_back(N_GENDER + N_AGE + N_OCCUPATION + 1);

        // Add the movie.id
        nzi.push_back(N_GENDER + N_AGE + N_OCCUPATION + N_GENRE + m);

        // Maintain the top-3 best items.
        float rating = fm_predict(order_1, (float*)order_2, RANK, bias, &nzi);
        if (rating > best_rating) {
            third_rating = second_rating;
            third_id = second_id;
            second_rating = best_rating;
            second_id = best_id;

            best_rating = rating;
            best_id = m;
        } else if (rating <= best_rating && rating > second_rating) {
            third_rating = second_rating;
            third_id = second_id;
            
            second_rating = rating;
            second_id = m;
        } else if (rating <= second_rating && rating > third_rating) {
            third_rating = rating;
            third_id = m;
        }
    }

    //return best_id; 
    // To add some noise, we let:
    // Pr[return best] = 0.5, Pr[return 2nd | not return best] = 2/3, Pr[return 3rd | not return best] = 1/3
    
    // We generate 2 random int number in the range [0, 256)
    unsigned char r[2] = {0, 0};
    ret_code = sgx_read_rand(r, 2);
    if (ret_code != SGX_SUCCESS) {
        return -1;
    }
    if (int(r[0]) >= 128) { 
        // Pr = 0.5
        return best_id;
    } else if (int(r[1]) > 85) {
        // Pr = 1/3
        return second_id;
    } else {
        return third_id;
    }
    
}

